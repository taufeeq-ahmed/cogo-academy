---
import TableStudents from "../../components/TableStudents";
import AdminLayout from "../../layouts/AdminLayout.astro";
import { fetchData, parseCookie } from "../../utils/common";

const cookies = parseCookie(Astro?.request?.headers?.get("cookie"));

const token = cookies?.cogoacademytoken;
const batch = cookies?.batch;
if (!token) {
  return Astro.redirect("/signin");
}
const data = await fetchData("users/isadmin", token);
if (!data) return Astro.redirect("/error");
---

<AdminLayout title="Admin | Students">
  <div style={{ marginTop: "20px", display: "flex", height: "100vh" }}>
    <TableStudents client:load />
  </div>
</AdminLayout>
