---
import Button from "../../components/Button/Button";
import ModalLayout from "../../layouts/ModalLayout.astro";
import AdminCourseCard from "../../components/AdminCourseCard/AdminCourseCard";
import AddCourse from "../../components/AddCourse/AddCourse";
import { fetchData, parseCookie } from "../../utils/common";
import cross from "/assets/cross.svg";
const cookies = parseCookie(Astro?.request?.headers?.get("cookie"));

const token = cookies?.cogoacademytoken;
const batch = cookies?.batch;
if (!token) {
    return Astro.redirect("/signin");
}
const data = await fetchData(`admin/courses`, token);
if (!data) return Astro.redirect("/error");
---

<ModalLayout title="Admin | Courses" user={data.user}>
    <div class="admin_dashboard_courses_container">
        <div class="create_course_container">
            <div class="header_title">Courses</div>
            <Button
                text="Create Course"
                id={"open_modal"}
                className="create_course_button"
            />
        </div>
        <div class="courses_container">
            {
                data?.courses?.map((course) => {
                    return <AdminCourseCard course={course} client:load />;
                })
            }
        </div>
    </div>
    <div slot="modal_header_slot" class="close_btn">
        <span>Add Course</span>
        <div class="btn"><img src={cross} id={"close_modal"} /></div>
    </div>
    <div slot="modal_content_slot">
        <AddCourse client:load />
    </div>
    <div slot="modal_footer_slot" class="modal_footer">
        <!-- <Button text="Close Modal" id={"close_modal"} /> -->
    </div>
</ModalLayout>
<style>
    .courses_container {
        display: flex;
        flex-wrap: wrap;
    }
    .course {
        flex: 1;
        min-width: calc(100% / 3);
        max-width: calc(100% / 3);
    }
    .create_course_container {
        display: flex;
        justify-content: space-between;
        padding: 0px 35px 0px 20px;
        /* width: 90%; */
    }
    .create_course_container .header_title {
        font-size: 24px;
    }
    .close_btn {
        display: flex;
        justify-content: space-between;
    }
    .btn {
        display: flex;
        justify-content: end;
        cursor: pointer;
    }
    @media (max-width: 900px) {
        .create_course_button {
            display: none !important;
        }
    }
</style>
