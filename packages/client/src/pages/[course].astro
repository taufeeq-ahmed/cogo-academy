---
import CourseSections from "../components/CourseSections";
import Layout from "../layouts/Layout.astro";
import { fetchData } from "../utils/common";

const token = Astro?.request?.headers?.get("cookie")?.split("=")[1];
if (!token) {
  return Astro.redirect("/signin");
}
const { course } = Astro.params;

const data = await fetchData(`landing/${course}`, token);
---

<Layout
  title={`Course - ${course}`}
  courses={data.allCourses}
  header_title={"Course"}
  isSearch
>
  <CourseSections
    sections={data.sections}
    userData={data.userData}
    client:load
  />
</Layout>
